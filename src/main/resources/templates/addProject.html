<!DOCTYPE html>
<html dir="ltr" lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <!-- Tell the browser to be responsive to screen width -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <!-- Favicon icon -->
    <link rel="icon" type="image/png" sizes="16x16" th:href="@{/assets/images/favicon.png}">
    <title>创建方案·网络情报分析系统</title>

    <!-- Custom CSS -->
    <link th:href="@{/dist/css/style.min.css}" rel="stylesheet">
    <link th:href="@{/dist/css/custom.css}" rel="stylesheet">
    <link th:href="@{/assets/libs/sweetalert2/dist/sweetalert2.min.css}" rel="stylesheet">
    <link rel="stylesheet" type="text/css" th:href="@{/assets/libs/bootstrap-datepicker/dist/css/bootstrap-datepicker.min.css}">
    <!--<script src="//at.alicdn.com/t/font_1709263_w16payhc3l.js"></script>-->
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script th:src="@{/common/analyze-cloud.js}"></script>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <script th:src="@{/common/analyze-cloud.js}"></script>

    <![endif]-->
    <style>
        input::-webkit-input-placeholder, textarea::-webkit-input-placeholder {
            color: #b6b7b7 !important;
        }
        input:-moz-placeholder, textarea:-moz-placeholder {
            color: #b6b7b7 !important;
        }
        input::-moz-placeholder, textarea::-moz-placeholder {
            color: #b6b7b7 !important;
        }
        input:-ms-input-placeholder, textarea:-ms-input-placeholder {
            color: #b6b7b7 !important;
        }
         .badge-info {
             color: #fff !important;
             background-color: #6184e6 !important;
         }

        .preference-time {
            display: inline-block;
            width: 300px;
        }
        .preference-time-list{
            display: flex;
            align-items: center;
        }
        .preference-time-list>span{
            display: inline-block;
        }

        .icon4{
            margin-left: auto;
            line-height: 15px;
        }

        .icon4 i{
            margin-left: 25px;
            cursor: pointer;
        }
    </style>
</head>
<body>

                <div class="card">
                    <div class="card-body">
                        <ul class="create-tab" id="search-tab">
                            <li class="create-tab-act" data-type="2">快速创建</li>
                            <li class="" data-type="1">高级创建</li>
                            <li id="tips" data-type="3">当前是快速创建，可设置550字</li>
                        </ul>
                        <!-- tab1 start -->
                        <div id="tab2" class="card m-b-0" style="display: none;">
                            <div class="card-body p-b-0">
                                <div class="create-line m-b-30">
                                    <span>方案名称</span>
                                    <input id="proname1" type="text" maxlength="10" class="form-control"
                                           placeholder="请输入方案名称">
                                    <span>*方案名称控制在6字符以内</span>
                                </div>
                                <div class="create-line m-b-30">
                                    <span>所属方案组名称</span>
                                    <select name="" id="groupList" class="form-control">
                                    </select>
                                </div>
                                <div class="create-line2 m-b-20">
                                    <span>方案主体关键词</span>
                                    <textarea class="form-control" name="" id="prokeywords1" rows="4"
                                              placeholder=''></textarea>
                                    <div class="create-tips">
                                        <a tabindex="0" class="" data-html="true" role="button" data-toggle="popover"
                                           data-trigger="focus" title="方案主体关键词提示"
                                           data-content="1：“+”表示“并且”,“|”表示“或”
														<br>
														2：什么情况下用“|”：
														如想关注北京或上海或广州的新闻，表达式为“北京|上海|广州”，表示文章中出现 “北京”、“上海”、“广州”任意一个城市就能监测到。
														<br>
														3：什么情况下用“+”：
														如想关注北京车牌摇号的新闻，表达式为“北京+车牌摇号”，表示文章中同时出现 “北京”和“车牌摇号”两个关键词才能监测到。
														<br>
														4：什么情况下同时用到“+”、“|”：
														如想关注上海世博会的新闻，由于“世博会”又可能被称为“世界博览会”，表达式为 “上海+(世博会|世界博览会)”，表示文章中出现“上海”，同时出现“世博会”或者 “世界博览会”中任意一个词，就能监测到；
														<br>
														5：什么情况下用到排除关键词：
														如想关注上海、北京、广州的新闻，但又不想看到内容中有“三室一厅”、“二室 一厅”这种关键词的广告，可以使用排除关键词的方式。 匹配关键词表达式“北京|上海|广州” 排除关键词表达式“三室一厅|二室一厅”">
                                            <i class="fa fa-question-circle"></i>
                                        </a>
                                    </div>
                                </div>
                                <div class="create-line2 m-b-20">
                                    <span>监测屏蔽歧义词</span>
                                    <textarea class="form-control" name="" id="proshield1" rows="4"
                                              placeholder=''></textarea>
                                    <div class="create-tips">
                                        <a tabindex="0" class="" data-html="true" role="button" data-toggle="popover"
                                           data-trigger="focus" title="监测屏蔽歧义词提示"
                                           data-content="1：“+”表示“并且”,“|”表示“或”
														<br>
														2：什么情况下用“|”：
														如想关注北京或上海或广州的新闻，表达式为“北京|上海|广州”，表示文章中出现 “北京”、“上海”、“广州”任意一个城市就能监测到。
														<br>
														3：什么情况下用“+”：
														如想关注北京车牌摇号的新闻，表达式为“北京+车牌摇号”，表示文章中同时出现 “北京”和“车牌摇号”两个关键词才能监测到。
														<br>
														4：什么情况下同时用到“+”、“|”：
														如想关注上海世博会的新闻，由于“世博会”又可能被称为“世界博览会”，表达式为 “上海+(世博会|世界博览会)”，表示文章中出现“上海”，同时出现“世博会”或者 “世界博览会”中任意一个词，就能监测到；
														<br>
														5：什么情况下用到排除关键词：
														如想关注上海、北京、广州的新闻，但又不想看到内容中有“三室一厅”、“二室 一厅”这种关键词的广告，可以使用排除关键词的方式。 匹配关键词表达式“北京|上海|广州” 排除关键词表达式“三室一厅|二室一厅”">
                                            <i class="fa fa-question-circle"></i>
                                        </a>
                                    </div>
                                </div>
                                <div class="create-line m-b-30">
                                    <span>来源网站</span>
                                    <input id="sourceWebsite1" type="text" class="form-control"
                                           placeholder="请输入来源网站">
                                </div>
                                <div class="create-line m-b-30">
                                    <span>作者名称</span>
                                    <input id="author1" type="text" class="form-control"
                                           placeholder="请输入作者名称">
                                </div>
                                <div class="p-t-10" >
                                    <!-- double line  start-->
                                    <div class="warning-edit-third ">
                                        <div class="warning-left">
                                            <div>情感属性</div>
                                            <div class=" m-l-0" id="emotion1">
                                                <span data-emotion=1 class="badge badge-pill badge-light">正面</span>
                                                <span data-emotion=2 class="badge badge-pill badge-light">中性</span>
                                                <span data-emotion=3 class="badge badge-pill badge-light">负面</span>
                                            </div>
                                        </div>
                                        <div class="warning-center">
                                            <div>相似文章</div>
                                            <div class=" m-l-0">
                                                <span data-similar=1 class="badge badge-pill badge-light">合并文章</span>
                                                <span data-similar=0 class="badge badge-pill badge-light">取消合并</span>
                                            </div>
                                        </div>
                                        <div class="warning-right">
                                            <div>精准筛选</div>
                                            <div class=" m-l-0">
                                                <span data-precise=1 class="badge badge-pill badge-light">打开精准</span>
                                                <span data-precise=0 class="badge badge-pill badge-light">关闭精准</span>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- double line end-->
                                    <!-- double line  start-->
                                    <div class="warning-edit-double" style="justify-content: inherit;">
                                        <div class="warning-left" style="width: 40%;">
                                            <div>信息排序</div>
                                            <div class=" m-l-0">
                                                <span data-sort=1 class="badge badge-pill badge-light">时间降序</span>
                                                <span data-sort=2 class="badge badge-pill badge-light">时间升序</span>
                                                <span data-sort=3 class="badge badge-pill badge-light">相似数量</span>
                                            </div>
                                        </div>
                                        <div class="warning-right">
                                            <div>匹配方式</div>
                                            <div style="margin-left: 0;">
                                                <span data-matchs=1 class="badge badge-pill badge-light">全文匹配</span>
                                                <span data-matchs=2 class="badge badge-pill badge-light">标题匹配</span>
                                                <span data-matchs=3 class="badge badge-pill badge-light">正文匹配</span>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- double line end-->
                                    <!-- double line  start-->
                                    <div class="warning-edit-double">
                                        <div class="warning-left w-100">
                                            <div class="preference-left">时间范围</div>
                                            <div class=" m-l-0 preference-time-list">
                                                <span data-time=1 class="badge badge-pill badge-light">24小时</span>
                                                <span data-time=3 class="badge badge-pill badge-light">昨天</span>
                                                <span data-time=2 class="badge badge-pill badge-light">今天</span>
                                                <span data-time=4 class="badge badge-pill badge-light">3天</span>
                                                <span data-time=5 class="badge badge-pill badge-light">7天</span>
                                                <span data-time=6 class="badge badge-pill badge-light">15天</span>
                                                <span data-time=7 class="badge badge-pill badge-light">30天</span>
                                                <span data-time=8 class="badge badge-pill badge-light">自定义</span>
                                                <div class="input-daterange monitor-date preference-time date-range" style="display:none"
                                                     >
                                                    <input type="text" class="form-control" name="start" placeholder="开始日期"/>
                                                    <input type="text" class="form-control" name="end" placeholder="结束日期"/>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="create-btn-group">
                                    <button class="btn btn-info m-r-10" type="button" id="gosubmit1">确定</button>
                                    <button class="btn btn-secondary" type="button" id="goback1">取消</button>
                                </div>
                            </div>
                        </div>
                        <!-- tab1 end -->
                        <!-- tab2 start -->
                        <div id="tab1" class="card m-b-0" >
                            <div class="card-body p-b-0">
                                <div class="create-line m-b-30">
                                    <span>方案名称</span>
                                    <input id="proname" type="text" maxlength="6" class="form-control"
                                           placeholder="请输入方案名称">
                                    <span>*方案名称控制在6字符以内</span>
                                </div>
                                <div class="create-line m-b-30">
                                    <span>所属方案组名称</span>
                                    <select name="" id="groupList2" class="form-control">
                                        <option value="1">涉及国家</option>
                                    </select>
                                </div>
                                <div class="create-line2 m-b-20">
                                    <span>方案主体关键词</span>
                                    <textarea class="form-control" name="" id="prokeywords" rows="4"
                                              placeholder='关键词之间用逗号","隔开&#13;&#10;例如：汽车行业，别克，辉腾，三菱'></textarea>
                                    <div class="create-tips">
                                        <a tabindex="0" class="" data-html="true" role="button" data-toggle="popover"
                                           data-trigger="focus" title="方案主体关键词提示"
                                           data-content="1、地域、人物、事件 三类都可输入多个关键词，关键词之间用英文逗号分开。三个类型都可以为空。<br>2、每一类的多个关键词之间默认为或(或者)”的关系。<br>3、地域、人物、事件三个类型之间是“与(并且)”的关系。例如：地域配置了“上海”，人物配置了“周某”，事件配置了“撞车”，只有同时满足这3个条件的文章才会被监测到。">
                                            <i class="fa fa-question-circle"></i>
                                        </a>
                                    </div>
                                </div>
                                <!-- <div class="create-line2 m-b-20">
                                    <span>国家/城市/地域 关键词</span>
                                    <textarea class="form-control" name="" id="proarea" rows="4"
                                              placeholder='关键词之间用逗号","隔开;例如：美国，上海，北京，滕家沟，南京西路'></textarea>
                                    <div class="create-tips">
                                        <a tabindex="0" class="" data-html="true" role="button" data-toggle="popover"
                                           data-trigger="focus" title="国家/城市/地域 关键词提示"
                                           data-content="1、地域、人物、事件 三类都可输入多个关键词，关键词之间用空格分开。三个类型都可以为空。<br>2、每一类的多个关键词之间默认为或(或者)”的关系。<br>3、地域、人物、事件三个类型之间是“与(并且)”的关系。例如：地域配置了“上海”，人物配置了“周某”，事件配置了“撞车”，只有同时满足这3个条件的文章才会被监测到。">
                                            <i class="fa fa-question-circle"></i>
                                        </a>
                                    </div>
                                </div> -->
                                <!-- <div class="create-line2 m-b-20">
                                    <span>人物/机构/企业 关键词</span>
                                    <textarea class="form-control" name="" id="properson" rows="4"
                                              placeholder='关键词之间用逗号","隔开；例如：马云，北京网安中心，腾讯科技'></textarea>
                                    <div class="create-tips">
                                        <a tabindex="0" class="" data-html="true" role="button" data-toggle="popover"
                                           data-trigger="focus" title="人物/机构/企业 关键词提示"
                                           data-content="1、地域、人物、事件 三类都可输入多个关键词，关键词之间用空格分开。三个类型都可以为空。<br>2、每一类的多个关键词之间默认为或(或者)”的关系。<br>3、地域、人物、事件三个类型之间是“与(并且)”的关系。例如：地域配置了“上海”，人物配置了“周某”，事件配置了“撞车”，只有同时满足这3个条件的文章才会被监测到。">
                                            <i class="fa fa-question-circle"></i>
                                        </a>
                                    </div>
                                </div> -->
                                <!-- <div class="create-line2 m-b-20">
                                    <span>事件/动词 关键词</span>
                                    <textarea class="form-control" name="" id="proaccident" rows="4"
                                              placeholder='关键词之间用逗号","隔开；例如：高管离职，拖欠工资，跑路，开销，焦虑'></textarea>
                                    <div class="create-tips">
                                        <a tabindex="0" class="" data-html="true" role="button" data-toggle="popover"
                                           data-trigger="focus" title="事件/动词 关键词提示"
                                           data-content="1、地域、人物、事件 三类都可输入多个关键词，关键词之间用空格分开。三个类型都可以为空。<br>2、每一类的多个关键词之间默认为或(或者)”的关系。<br>3、地域、人物、事件三个类型之间是“与(并且)”的关系。例如：地域配置了“上海”，人物配置了“周某”，事件配置了“撞车”，只有同时满足这3个条件的文章才会被监测到。">
                                            <i class="fa fa-question-circle"></i>
                                        </a>
                                    </div>
                                </div> -->
                                <div class="create-line2 m-b-20">
                                    <span>监测屏蔽歧义词</span>
                                    <textarea class="form-control" name="" id="proshield" rows="4"
                                              placeholder='屏蔽词之间用逗号","隔开&#13;&#10;例如：合作，用不，二娃，流连'></textarea>
                                    <div class="create-tips">
                                        <a tabindex="0" class="" data-html="true" role="button" data-toggle="popover"
                                           data-trigger="focus" title="监测屏蔽歧义词提示"
                                           data-content="1、地域、人物、事件 三类都可输入多个关键词，关键词之间用英文逗号分开。三个类型都可以为空。<br>2、每一类的多个关键词之间默认为或(或者)”的关系。<br>3、地域、人物、事件三个类型之间是“与(并且)”的关系。例如：地域配置了“上海”，人物配置了“周某”，事件配置了“撞车”，只有同时满足这3个条件的文章才会被监测到。">
                                            <i class="fa fa-question-circle"></i>
                                        </a>
                                    </div>
                                </div>
                                <div class="create-line m-b-30">
                                    <span>来源网站</span>
                                    <input id="sourceWebsite2" type="text" class="form-control"
                                           placeholder="请输入来源网站">
                                </div>
                                <div class="create-line m-b-30">
                                    <span>作者名称</span>
                                    <input id="author2" type="text" class="form-control"
                                           placeholder="请输入作者名称">
                                </div>
                                <div class="p-t-10" >
                                    <!-- double line  start-->
                                    <div class="warning-edit-third ">
                                        <div class="warning-left">
                                            <div>情感属性</div>
                                            <div class=" m-l-0" id="emotion2">
                                                <span data-emotion=1 class="badge badge-pill badge-light">正面</span>
                                                <span data-emotion=2 class="badge badge-pill badge-light">中性</span>
                                                <span data-emotion=3 class="badge badge-pill badge-light">负面</span>
                                            </div>
                                        </div>
                                        <div class="warning-center">
                                            <div>相似文章</div>
                                            <div class=" m-l-0">
                                                <span data-similar=1 class="badge badge-pill badge-light">合并文章</span>
                                                <span data-similar=0 class="badge badge-pill badge-light">取消合并</span>
                                            </div>
                                        </div>
                                        <div class="warning-right">
                                            <div>精准筛选</div>
                                            <div class=" m-l-0">
                                                <span data-precise=1 class="badge badge-pill badge-light">打开精准</span>
                                                <span data-precise=0 class="badge badge-pill badge-light">关闭精准</span>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- double line end-->
                                    <!-- double line  start-->
                                    <div class="warning-edit-double" style="justify-content: inherit;">
                                        <div class="warning-left" style="width: 40%;">
                                            <div>信息排序</div>
                                            <div class=" m-l-0">
                                                <span data-sort=1 class="badge badge-pill badge-light">时间降序</span>
                                                <span data-sort=2 class="badge badge-pill badge-light">时间升序</span>
                                                <span data-sort=3 class="badge badge-pill badge-light">相似数量</span>
                                            </div>
                                        </div>
                                        <div class="warning-right">
                                            <div>匹配方式</div>
                                            <div style="margin-left: 0;">
                                                <span data-matchs=1 class="badge badge-pill badge-light">全文匹配</span>
                                                <span data-matchs=2 class="badge badge-pill badge-light">标题匹配</span>
                                                <span data-matchs=3 class="badge badge-pill badge-light">正文匹配</span>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- double line end-->
                                    <!-- double line  start-->
                                    <div class="warning-edit-double">
                                        <div class="warning-left w-100">
                                            <div class="preference-left">时间范围</div>
                                            <div class=" m-l-0 preference-time-list">
                                                <span data-time=1 class="badge badge-pill badge-light">24小时</span>
                                                <span data-time=3 class="badge badge-pill badge-light">昨天</span>
                                                <span data-time=2 class="badge badge-pill badge-light">今天</span>
                                                <span data-time=4 class="badge badge-pill badge-light">3天</span>
                                                <span data-time=5 class="badge badge-pill badge-light">7天</span>
                                                <span data-time=6 class="badge badge-pill badge-light">15天</span>
                                                <span data-time=7 class="badge badge-pill badge-light">30天</span>
                                                <span data-time=8 class="badge badge-pill badge-light">自定义</span>
                                                <div class="input-daterange monitor-date preference-time date-range" style="display:none"
                                                     >
                                                    <input type="text" class="form-control" name="start" placeholder="开始日期"/>
                                                    <input type="text" class="form-control" name="end" placeholder="结束日期"/>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="create-btn-group">
                                    <button class="btn btn-info m-r-10" type="button" id="gosubmit">确定</button>
                                    <button class="btn btn-secondary" type="button" id="goback">取消</button>
                                </div>
                            </div>
                        </div>
                        <!-- tab2 end -->
                    </div>
                </div>
            </div>
            <div class="page-footer">
                © 2014-<span id="currentyear"></span> 南京涌亿思信息技术有限公司 苏ICP备17066984号-1
            </div>
        </div>
    </div>
</div>
<script th:src="@{/assets/libs/jquery/dist/jquery.min.js}"></script>
<!-- Bootstrap tether Core JavaScript -->
<script th:src="@{/assets/libs/popper.js/dist/umd/popper.min.js}"></script>
<script th:src="@{/assets/libs/bootstrap/dist/js/bootstrap.min.js}"></script>
<!-- apps -->
<script th:src="@{/dist/js/app.min.js}"></script>
<script th:src="@{/dist/js/app.init.light-sidebar.js}"></script>
<script th:src="@{/dist/js/app-style-switcher.js}"></script>
<!-- slimscrollbar scrollbar JavaScript -->
<script th:src="@{/assets/libs/perfect-scrollbar/dist/perfect-scrollbar.jquery.min.js}"></script>
<script th:src="@{/assets/extra-libs/sparkline/sparkline.js}"></script>
<!--Wave Effects -->
<script th:src="@{/dist/js/waves.js}"></script>
<!--Menu sidebar -->
<script th:src="@{/dist/js/sidebarmenu.js}"></script>
<!--Custom JavaScript -->
<script th:src="@{/dist/js/custom.min.js}"></script>
<!-- this pages -->
<script th:src="@{/dist/js/projectlist.js}"></script>
<!-- 分页 -->
<script th:src="@{/dist/js/pages.js}"></script>
<!-- 右上角提示 -->
<script th:src="@{/assets/libs/block-ui/jquery.blockUI.js}"></script>
<script th:src="@{/common/tools.js}"></script>
<!-- 提示框 -->
<script th:src="@{/assets/libs/sweetalert2/dist/sweetalert2.all.min.js}"></script>
<script th:src="@{/dist/baidu/baidu_statistics.js}"></script>
                <script th:src="@{/assets/libs/bootstrap-datepicker/dist/js/bootstrap-datepicker.min.js}"></script>
                <script th:src="@{/assets/libs/bootstrap-datepicker/dist/locales/bootstrap-datepicker.zh-CN.min.js}"></script>
<script th:inline="javascript" type="text/javascript">
    $("#currentyear").text((new Date()).getFullYear());

    var groupId = [[${groupId}]];

    $(document).ready(function () {
        sendGroupByadd();  // 组装方案组数据
        getOpinionConditionByProjectId()
    });

    // 左侧方案切换
    function switchProject(event) {
        let $event = $(event);
        groupId = $event.attr("data-groupid");
        projectId = $event.attr("data-index");
        window.location.href = ctxPath + 'project/detail?groupid='+groupId+'&projectid='+projectId;
    }

    /**
     * @author huajiancheng
     * @date 2020/04/15
     * @description 发送新增方案的信息
     */
    function sendProjectInfo(data) {
        //新增方案
        $.ajax({
            url: "/defaultProject/addProject",
            type: "post",
            contentType: 'application/json;charset=utf-8',
            data: JSON.stringify(data),
            success: function (res) {
                console.log(res)
                let code = res.code;
                let msg = res.msg;
                if (code == 200) {
                    showInfo("新增成功");
                    //返回之前的页面
                    window.location.href = "/defaultProject/list";
                } else {
                    showInfo(msg);
                }
            },
            error: function (xhr, ajaxOptions, thrownError) {
                if (xhr.status == 403) {
                    window.location.href = ctxPath + "login";
                } else {
                    console.log(thrownError);
                }
            }
        });
    }

    function sendGroupByadd() {
        $.ajax({
            type: "get",
            url: "/defaultProject/getDefaultGroupList",
            contentType: "application/json;charset=UTF-8",
            success: function (res) {
                let code = res.status;
                if (code === 200) {
                    let data = res.data;
                    let groupStr = '';
                    for (let i = 0; i < data.length; i++) {
                        let dataJson = data[i];
                        let group_id = dataJson.group_id;
                        let group_name = dataJson.group_name;
                        if (group_id == groupId) {
                            groupStr += '<option selected value="' + group_id + '">' + group_name + '</option>'
                        } else {
                            groupStr += '<option value="' + group_id + '">' + group_name + '</option>'
                        }
                    }
                    $("#groupList").html(groupStr); // 修改方案 普通方案 方案组下拉框
                    $("#groupList2").html(groupStr); // 修改方案 高级方案 方案组下拉框
                } else {
                    showInfo("出错啦，请稍后再试");
                }
            },
            error: function (xhr, ajaxOptions, thrownError) {
                if (xhr.status == 403) {
                    window.location.href = ctxPath + "login";
                } else {
                    console.log(thrownError);
                }
            }
        });
    }

    /**
     * @author liyoulin
     * @date 2020/04/15
     * @description 切换快速创建和高级方案
     */
    $("#search-tab li").on("click", function () {
        var tip = $(this).attr("data-type")
        switch (tip) {
            case "2":
                $(this).siblings().removeClass("create-tab-act");
                $(this).addClass("create-tab-act");
                $("#tips").html("当前是快速创建，可设置550字");
                $("#tab2").hide();
                $("#tab1").show();
                break;
            case "1":
                $(this).siblings().removeClass("create-tab-act");
                $(this).addClass("create-tab-act");
                $("#tips").html("当前是高级创建，可设置100字");
                $("#tab1").hide();
                $("#tab2").show();
                break;
            case "3":
                break;
            default:
                break;
        }
    });

    /**
     * @author huajiancheng
     * @date 2020/04/15
     * @description 高级创建
     * @param message 提示的信息
     */
    $("#gosubmit1").click(function (param) {
        var proname = $("#proname1").val().trim();  // 方案名称
        var prokeywords = $("#prokeywords1").val().trim();  // 关键词
        var proshield = $("#proshield1").val().trim(); // 屏蔽词
        if (proname == '') {
            $("#proname1").addClass("text-error");
            showtips("请填写方案名称！");
            return;
        } else {
            $("#proname1").removeClass("text-error");
        }
        if(proname.length>6){
            showtips("方案名称长度最多六个字符");
            return;
        }
        if (prokeywords == '') {
            $("#prokeywords1").addClass("text-error");
            showtips("请填写方案主体关键词！")
            return;
        } else {
            $("#prokeywords1").removeClass("text-error");
        }
        if (prokeywords == proshield) {
            showtips("关键词与屏蔽词不能相同");
            return;
        }

        var flag = new RegExp("[`~!@#$^&*=\\-{}':;,'\\[\\].<>《》/?~！@#￥……&*（）——{}【】‘；：”“'。，、？ ]")
        let characterList = "`~!@#$^&*=\-{}':;,'\[\].<>《》/?~！@#￥……&*（）——{}【】‘；：”“'。，、？ ".split("")
        let tiptext = "其他特殊符号"

        if (flag.test(prokeywords)) {
            $("#prokeywords1").addClass("text-error");
            for (let i = 0; i < characterList.length; i++) {
                if(prokeywords.indexOf(characterList[i])>-1){
                    tiptext = characterList[i]
                    if(characterList[i]==" "){
                        tiptext = "空格"
                    }
                    break;
                }
            }
            showtips("关键词内容只能使用+|()这三种符号，不能使用"+tiptext);
            return;
        }

        if (flag.test(proshield)) {
            $("#proshield1").addClass("text-error");
            for (let i = 0; i < characterList.length; i++) {
                if(proshield.indexOf(characterList[i])>-1){
                    tiptext = characterList[i]
                    if(characterList[i]==" "){
                        tiptext = "空格"
                    }
                    break;
                }
            }
            showtips("屏蔽词内容只能使用+|()这三种符号，不能使用"+tiptext);
            return;
        }


        $("#createcomplete").addClass("line-active");

        prokeywords = prokeywords.toString().replace(/(\s|;|-|"|‘|；|、|‘’|'|’|“”|》|《|<|>|\.|。)/g, ",");
        prokeywords = prokeywords.toString().replace(/,{1,}/, ",");
        if (prokeywords.indexOf("，") != -1) {
            prokeywords = prokeywords.toString().replace(new RegExp("，", 'gm'), ",");
        }
        proshield = proshield.toString().replace(/(\s|;|-|"|‘|；|、|‘’|'|’|“”|》|《|<|>|\.|。)/g, ",");
        proshield = proshield.toString().replace(/,{1,}/, ",");
        if (proshield.indexOf("，") != -1) {
            proshield = proshield.toString().replace(new RegExp("，", 'gm'), ",");
        }



        let prokeywordsArray = prokeywords.split(",");
        if (prokeywordsArray.length >= 100) {
            showInfo("关键词不能超过100个！");
        }


        let proshieldArray = proshield.split(",");
        if (proshieldArray.length >= 100) {
            showInfo("屏蔽词词不能超过100个！");
        }

        if (proname != '' && prokeywords != '' && proshieldArray.length < 100 && prokeywordsArray.length < 100) {
            let group_id = $("#groupList option:selected").val().trim();
            let dataJson = new Object();
            dataJson.project_name = proname;
            dataJson.subject_word = prokeywords;
            dataJson.stop_word = proshield;
            dataJson.group_id = group_id;
            dataJson.project_type = 1;
            let params = new Object(); // ajax基本的参数
            let condition = getCondition();
            //获取emotion1的值
            let emotion = new Array();
            $("#emotion2 span.badge-info").each(function () {
                emotion.push($(this).attr("data-emotion"));
            });
            condition.emotion = emotion;
            //获取sourceWebsite1的值
            let sourceWebsite1 = $("#sourceWebsite1").val().trim();
            //获取author1的值
            let author1 = $("#author1").val().trim();
            condition.websitename = sourceWebsite1;
            condition.author = author1;
            params.project = dataJson;
            params.condition = condition;
            sendProjectInfo(params);
        }
    });


    $("#goback1").click(function (param) {
        $("#proname1").removeClass("text-error");
        $("#prokeywords1").removeClass("text-error");
        $("#proshield1").removeClass("text-error");
        $("#createcomplete").removeClass("line-active");
        window.location.href = ctxPath + "project";
    });


    $(document).on('click', '#goback', function (param) {
        $("#proname1").removeClass("text-error");
        $("#prokeywords1").removeClass("text-error");
        $("#proshield1").removeClass("text-error");
        $("#createcomplete").removeClass("line-active");
        window.location.href = ctxPath + "project";
    });


    // 快速创建
    $("#gosubmit").click(function () {
        var proname = $("#proname").val();
        var prokeywords = $("#prokeywords").val();
        // var properson = $("#properson").val();
        var properson = '';
        //var proarea = $("#proarea").val();
        var proarea = '';
        //var proaccident = $("#proaccident").val();
        var proaccident = '';
        var proshield = $("#proshield").val();

        if (proname == '') {
            $("#proname").addClass("text-error");
            showtips("请填写方案名称！")
            return;
        } else {
            $("#proname").removeClass("text-error");
        }
        if (prokeywords == '') {
            $("#prokeywords").addClass("text-error");
            showtips("请填写方案主体关键词！");
            return;
        } else {
            $("#prokeywords").removeClass("text-error");
        }


        if (prokeywords == proshield) {
            showtips("关键词与屏蔽词不能相同");
            return;
        }

        var flag = new RegExp("[`~!@#$^&*()=+\\-|{}':;'\\[\\].<>《》/?~！@#￥……&*（）——{}【】‘；：”“'。，、？ ]")
        let characterList = "`~!@#$^&*()=+\-|{}':;'\[\].<>《》/?~！@#￥……&*（）——{}【】‘；：”“'。，、？ ".split("")
        let tiptext = "其他特殊符号"

        if (flag.test(prokeywords)) {
            $("#prokeywords1").addClass("text-error");
            for (let i = 0; i < characterList.length; i++) {
                if(prokeywords.indexOf(characterList[i])>-1){
                    tiptext = characterList[i]
                    if(characterList[i]==" "){
                        tiptext = "空格"
                    }
                    break;
                }
            }
            showtips("关键词内容只能使用英文逗号，不能使用"+tiptext);
            return;
        }

        if (flag.test(proshield)) {
            $("#proshield1").addClass("text-error");
            for (let i = 0; i < characterList.length; i++) {
                if(proshield.indexOf(characterList[i])>-1){
                    tiptext = characterList[i]
                    if(characterList[i]==" "){
                        tiptext = "空格"
                    }
                    break;
                }
            }
            showtips("屏蔽词内容只能使用英文逗号，不能使用"+tiptext);
            return;
        }



        prokeywords = prokeywords.toString().replace(/(\s|;|-|"|‘|；|、|‘’|'|’|“”|》|《|<|>|\.|。)/g, "|");
        prokeywords = prokeywords.toString().replace(/,{1,}/, ",");
        if (prokeywords.indexOf("，") != -1) {
            prokeywords = prokeywords.toString().replace(new RegExp("，", 'gm'), "|");
        }

        if (properson.indexOf("，") != -1) {
            properson = properson.toString().replace(new RegExp("，", 'gm'), "|");
        }

        if (proarea.indexOf("，") != -1) {
            proarea = proarea.toString().replace(new RegExp("，", 'gm'), "|");
        }

        if (proaccident.indexOf("，") != -1) {
            proaccident = proaccident.toString().replace(new RegExp("，", 'gm'), "|");
        }

        proshield = proshield.toString().replace(/(\s|;|-|"|‘|；|、|‘’|'|’|“”|》|《|<|>|\.|。)/g, "|");
        proshield = proshield.toString().replace(/,{1,}/, "|");
        if (proshield.indexOf("，") != -1) {
            proshield = proshield.toString().replace(new RegExp("，", 'gm'), "|");
        }


        let prokeywordsArray = prokeywords.split(",");
        if (prokeywordsArray.length >= 100) {
            showInfo("关键词不能超过100个！");
        }


        let propersonArray = properson.split(",");
        if (propersonArray.length >= 100) {
            showInfo("人物词不能超过100个！");
        }


        let proareaArray = proarea.split(",");
        if (proareaArray.length >= 100) {
            showInfo("地域词不能超过100个！");
        }

        let proaccidentArray = proaccident.split(",");
        if (proaccidentArray.length >= 100) {
            showInfo("事件词不能超过100个！");
        }


        let proshieldArray = proshield.split(",");
        if (proshieldArray.length >= 100) {
            showInfo("屏蔽词不能超过100个！");
        }

        if (proname != '' && prokeywords != '' && prokeywordsArray.length <100
            && propersonArray.length <100 && proareaArray.length <100
            && proaccidentArray.length <100 && proshieldArray.length <100) {
            let group_id = $("#groupList2 option:selected").val();
            let dataJson = new Object();
            dataJson.project_name = proname;
            dataJson.subject_word = prokeywords;
            dataJson.stop_word = proshield;
            dataJson.group_id = group_id;
            dataJson.project_type = 2;
            dataJson.event_word = proaccident; // 事件关键词
            dataJson.regional_word = proarea; // 地域词
            dataJson.character_word = properson;  // 人物关键词
            let param = new Object(); // ajax基本的参数
            let condition = getCondition();
            //读取情感属性
            let emotion = new Array();
            $("#emotion2 span.badge-info").each(function () {
                emotion.push($(this).attr("data-emotion"));
            });
            condition.emotion = emotion;
            //获取sourceWebsite2的值
            let sourceWebsite2 = $("#sourceWebsite2").val().trim();
            //获取author2的值
            let author2 = $("#author2").val().trim();
            condition.websitename = sourceWebsite2;
            condition.author = author2;
            param.project = dataJson;
            param.condition = condition;
            sendProjectInfo(param);
        }
    });

    $('.navLi').click(function(){
        jumpNavLocation($(this).data('type'), groupId, null);
    })

    // 偏好设置信息
    function getOpinionConditionByProjectId() {

                    // $('#conditionGroup').show();
                    $('#btnGroup').show();
                    $('#nodata').html('');

                    $('span[data-time=' + 1 + ']').addClass('badge-info');
                    $('span[data-time=' + 1 + ']').siblings().removeClass('badge-info');

                    $('span[data-precise=' + 0 + ']').addClass('badge-info');
                    $('span[data-precise=' + 0 + ']').siblings().removeClass('badge-info');

                    $('span[data-similar=' + 0 + ']').addClass('badge-info');
                    $('span[data-similar=' + 0 + ']').siblings().removeClass('badge-info');

                    $('span[data-sort=' + 1 + ']').addClass('badge-info');
                    $('span[data-sort=' + 1 + ']').siblings().removeClass('badge-info');

                    $('span[data-matchs=' + 1 + ']').addClass('badge-info');
                    $('span[data-matchs=' + 1 + ']').siblings().removeClass('badge-info');


                    $('span[data-emotion]').removeClass('badge-info');

                    var emotion = JSON.parse('[1,2,3]');
                        for (var i = 0; i < emotion.length; i++) {
                            $('span[data-emotion=' + emotion[i] + ']').addClass('badge-info');
                        }


    }

    $('span[data-time]').click(function () {
        $(this).addClass('badge-info');
        $(this).siblings().removeClass('badge-info');
        let time = $(this).attr("data-time");
        if (time == 8) {
            $(".date-range").css("display", "block");
            let times = getnow();
            let timed = getnow();
            $(".date-range input[name=start]").val(times);
            $(".date-range input[name=end]").val(timed);
        } else {
            $(".date-range").css("display", "none");
        }
    });

    $('span[data-precise]').click(function () {
        $(this).addClass('badge-info');
        $(this).siblings().removeClass('badge-info');
    });

    $('span[data-similar]').click(function () {
        $(this).addClass('badge-info');
        $(this).siblings().removeClass('badge-info');
    });

    $('span[data-sort]').click(function () {
        $(this).addClass('badge-info');
        $(this).siblings().removeClass('badge-info');
    });

    $('span[data-matchs]').click(function () {
        $(this).addClass('badge-info');
        $(this).siblings().removeClass('badge-info');
    });

    $('span[data-emotion]').click(function () {
        if ($(this).hasClass('badge-info')) {
            $(this).removeClass('badge-info');
        } else {
            $(this).addClass('badge-info');
        }
    });


    $(".date-range input").change(function () {
        let times = $(".date-range input[name=start]").val();
        let timed = $(".date-range input[name=end]").val();
        if (times > timed) {
            showtips("开始时间不能迟于结束时间");
        } else {
            if (times != "" && timed != "") {
                let project_id = $('#projectSelect').val();
                let condition = getCondition();
                condition.project_id = project_id;
                condition.timee = timed;
                condition.times = times;
                let parambasic = new Object(); // ajax基本的参数
                parambasic.type = "POST";
                parambasic.url = ctxPath + 'system/updateOpinionCondition';
                parambasic.contentType = 'application/json;charset=utf-8';
                sendCondition(parambasic, JSON.stringify(condition), conditionTip);
            } else {
                showtips("开始时间或结束时间不能为空");
            }
        }
    });


    /**
     * @author liyoulin
     * @date 2020/04/16
     * @description  Date Picker  时间控件
     */

    $('.date-range').datepicker({
        language: 'zh-CN',
        format: "yyyy-mm-dd",
        orientation: "bottom auto",
        toggleActive: true,
        keyboardNavigation: true,
        enableOnReadonly: false,
        todayHighlight: true,
        endDate: getnow(),
        autoclose: true
    });

    function getnow() {
        var now = new Date();
        var month = now.getMonth() + 1;
        if(month < 10) month = '0' + month;
        var day = now.getDate();
        if(day < 10) day = '0' + day;
        var nowday = now.getFullYear() + "-" + month + "-" + day;
        return nowday
    }


    /**
     * @author hujiancheng
     * @date 2020/04/22
     * @description  改变更新偏好设置
     */
    function changeCondition() {
        let project_id = $('#projectSelect').val();
        let condition = getCondition();
        condition.project_id = project_id;
        let parambasic = new Object(); // ajax基本的参数
        parambasic.type = "POST";
        parambasic.url = ctxPath + 'system/updateOpinionCondition';
        parambasic.contentType = 'application/json;charset=utf-8';
        console.log(condition)
        sendCondition(parambasic, JSON.stringify(condition), conditionTip);
    }

    /**
     * @author hujiancheng
     * @date 2020/04/22
     * @description  请求偏好设置数据
     */
    function sendCondition(param, data, funcname) {
        $.ajax({
            type: param.type,
            url: param.url,
            dataType: 'json',
            data: data,
            contentType: param.contentType,
            success: function (res) {
                funcname(res);
            },
            error: function (xhr, ajaxOptions, thrownError) {
                if (xhr.status == 403) {
                    window.location.href = ctxPath + "login";
                }
            }
        });
    }

    /**
     * @author hujiancheng
     * @date 2020/04/22
     * @description  提示
     */
    function conditionTip(res) {
        console.log(res);
        let message = res.message;
        showtips(message)
    }


    /**
     * @author hujiancheng
     * @date 2020/04/22
     * @description  获取编号设置条件
     */
    function getCondition() {
        let time = 1;
        let precise = 0;
        let emotion = [];
        let similar = 0;
        let sort = 1;
        let matchs = 1;
        let times = '';
        let timee = '';

        $('span[data-time]').each(function () {
            if ($(this).hasClass('badge-info')) {
                time = $(this).data('time');
            }
        });

        if (time == 8) {
            times = $(".date-range input[name=start]").val();
            timee = $(".date-range input[name=end]").val();
        }

        $('span[data-emotion]').each(function () {
            if ($(this).hasClass('badge-info')) {
                emotion.push($(this).data('emotion'));
            }
        });

        $('span[data-precise]').each(function () {
            if ($(this).hasClass('badge-info')) {
                precise = $(this).data('precise');
            }
        });

        $('span[data-similar]').each(function () {
            if ($(this).hasClass('badge-info')) {
                similar = $(this).data('similar');
            }
        });

        $('span[data-sort]').each(function () {
            if ($(this).hasClass('badge-info')) {
                sort = $(this).data('sort');
            }
        });

        $('span[data-matchs]').each(function () {
            if ($(this).hasClass('badge-info')) {
                matchs = $(this).data('matchs');
            }
        });
        let condition = new Object();
        condition.time = time;
        condition.precise = precise;
        condition.emotion = emotion;
        condition.similar = similar;
        condition.sort = sort;
        condition.matchs = matchs;
        condition.times = times;
        condition.timee = timee;
        return condition;
    }

    $('.navLi').click(function(){
        jumpNavLocation($(this).data('type'), null, null);
    })

    $('#iconall i').click(function(){
        var type = $(this).data('type');
        var groupId = $('#groupSelect').val();
        var projectId = $('#projectSelect').val();
        var param = '';
        if(groupId){
            param = '?groupid='+groupId;
            if(projectId){
                if(type == 'project'){
                    param = '/editproject' + param + '&projectid='+projectId;
                }else{
                    param += '&projectid='+projectId;
                }
            }
        }
        window.location.href = ctxPath + type + param;
    })

    /**
     * @author huajiancheng
     * @date 2020/04/15
     * @description 提示信息框
     * @param message 提示的信息
     */
    function showInfo(message) {
        $.blockUI({
            message: message,
            fadeIn: 700,
            fadeOut: 700,
            timeout: 3000,
            showOverlay: false,
            centerY: false,
            css: {
                width: '250px',
                top: '20px',
                left: '',
                right: '20px',
                border: 'none',
                padding: '15px 5px',
                backgroundColor: '#000',
                '-webkit-border-radius': '10px',
                '-moz-border-radius': '10px',
                opacity: 0.9,
                color: '#fff'
            }
        });
    }

</script>
</body>

</html>